# Бэкенд-часть приложения

## Описание
Бэкенд приложения написан на языке Go и предоставляет REST API для работы с каталогом товаров. 

## Особенности Dockerfile

При создании Dockerfile для бэкенда были реализованы следующие решения и оптимизации:

### 1. Многоэтапная сборка (Multi-stage build)
Использование двух этапов сборки:
- **Этап сборки**: использует `golang:1.17-alpine` для компиляции исходного кода
- **Финальный этап**: использует минимальный образ `alpine:3.16` для запуска бинарного файла

Это позволяет значительно уменьшить размер финального образа, так как он не содержит инструменты разработки и исходный код.

### 2. Оптимизация кэширования слоев Docker
Порядок команд в Dockerfile организован для максимального использования кэширования:
- Сначала копируются только файлы зависимостей `go.mod` и `go.sum`
- Затем выполняется `go mod download`
- И только потом копируется весь исходный код

Это позволяет не пересобирать зависимости при каждом изменении исходного кода.

### 3. Минимизация размера образа
- Используются флаги компиляции Go для статической сборки и удаления отладочной информации:
  ```
  CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -ldflags="-w -s"
  ```
- Базовым образом является Alpine Linux
- Создан `.dockerignore` для исключения ненужных файлов при сборке

### 4. Безопасность
- Приложение запускается от непривилегированного пользователя `appuser`
- Установлены ограниченные права доступа к исполняемому файлу (`chmod 500`)
- Минимизировано количество установленных пакетов в финальном образе

### 5. Дополнительные особенности
- Установка сертификатов CA для поддержки HTTPS-соединений с внешними сервисами
- Корректная обработка сигналов для graceful shutdown
- Использование флага `--no-cache` для минимизации размера слоёв

## Результаты

Размер финального образа: **24 МБ**

## Инструкция по сборке и запуску

```bash
# Сборка образа
cd backend

docker build -t backend-app .

# Запуск контейнера
docker run -d -p 8081:8081 --name backend-container backend-app

# Проверка работоспособности
curl http://localhost:8081/health

# Получение списка продуктов
curl http://localhost:8081/products
```

# Фронтенд-часть приложения

## Описание
Фронтенд приложения написан на TypeScript с использованием Vue.js и предоставляет пользовательский интерфейс для взаимодействия с каталогом товаров.

## Особенности Dockerfile

При создании Dockerfile для фронтенда были реализованы следующие решения и оптимизации:

### 1. Многоэтапная сборка (Multi-stage build)
Использование двух этапов сборки:
- **Этап сборки**: использует `node:16-alpine` для компиляции исходного кода
- **Финальный этап**: использует `nginx:stable-alpine` для обслуживания статических файлов

Это позволяет значительно уменьшить размер финального образа, исключив из него Node.js, npm и все исходные файлы.

### 2. Оптимизация кэширования слоев Docker
Порядок команд в Dockerfile организован для максимального использования кэширования:
- Сначала копируются только файлы зависимостей `package.json` и `package-lock.json`
- Затем выполняется `npm ci --no-audit --no-fund`
- И только потом копируется весь исходный код

Это позволяет не переустанавливать зависимости при каждом изменении исходного кода.

### 3. Минимизация размера образа
- Использование легковесных образов на основе Alpine Linux
- Флаги `--no-audit --no-fund` при установке NPM-зависимостей
- Копирование только скомпилированных файлов из этапа сборки в финальный образ

### 4. Безопасность
- Создание непривилегированного пользователя `appuser` в группе `appgroup`
- Запуск приложения от непривилегированного пользователя через `USER appuser`
- Установлены корректные права доступа на все директории и файлы

### 5. Оптимизация Nginx
- Настроено сжатие (gzip) для уменьшения размера передаваемых данных
- Настроено кеширование статических файлов с помощью заголовков Cache-Control
- Учтен publicPath из конфигурации Vue.js (/momo-store/)

## Результаты

Размер финального образа: **51.7 МБ**

## Инструкция по сборке и запуску

```bash
# Сборка образа
cd frontend

docker build -t frontend-app .

# Запуск контейнера
docker run -d -p 80:80 --name frontend-container frontend-app

# Проверка доступности
curl http://localhost/momo-store/
```
